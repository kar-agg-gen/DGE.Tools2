% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/volcanoPlot.R
\name{volcanoPlot}
\alias{volcanoPlot}
\title{Create volcano plot}
\usage{
volcanoPlot(
  contrastDF,
  logRatioCol = "logFC",
  logIntCol = "AveExpr",
  pvalCol = "P.Value",
  pthreshold = 0.01,
  geneSymLabels,
  geneSymCol,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  symbolSize = c(4, 3.999, 4),
  symbolShape = c(21, 1, 21),
  symbolColor = c("black", "grey25", "grey0"),
  symbolFill = c("red3", "grey25", "deepskyblue4"),
  alpha = 0.5,
  sizeByIntensity = TRUE,
  pthresholdLine = NULL,
  foldChangeLines = log2(1.5),
  refLineThickness = 1,
  legendPosition = "right",
  rugColor = NULL,
  rugAlpha = 1,
  baseFontSize = 12,
  themeStyle = "grey",
  footnote,
  footnoteSize = 3,
  footnoteColor = "black",
  footnoteJust = 1
)
}
\arguments{
\item{contrastDF}{A dataframe with LogRatio and LogIntensity columns and optionally a
p-value or FDR column (typically a topTable dataframe).}

\item{logRatioCol}{Name of the LogRatio column (Default = "logFC")}

\item{logIntCol}{Name of the LogIntensity column (Default = "AveExpr")}

\item{pvalCol}{Name of the p-value or FDR column (Default = "P.Value")}

\item{pthreshold}{Used to color points (Default = 0.01)}

\item{geneSymLabels}{A character vector of gene to label (must be the name space of the column
specified by geneSymCol)}

\item{geneSymCol}{Name of the gene symbol column in contrastDF.  The gene symbol is
not in topTable output by default so the user has to bind this column
to the dataframe in advance.  This column will be used to label
significantly changed points.}

\item{xlab}{X axis label (Default is the LogIntensity column name)}

\item{ylab}{Y axis label (Default is the LogRatio column name)}

\item{title}{Plot title (optional)}

\item{symbolSize}{Size of symbols for Up, no change, and Down. default = c(4,
3.99, 4); Note: All three cannot be the same size. Decimal values are acceptable to help offset that
(e.g. 4, 4.1, 4.2).}

\item{symbolShape}{Shape of the symbols for Up, no change, and Down; Default =
c(21, 1, 21) (1 = open circle, 21 = fillable open circle); Note: The same symbol shape cannot
be selected for all three symbols. See
\url{http://www.cookbook-r.com/Graphs/Shapes_and_line_types}}

\item{symbolColor}{c(Up, NoChange, Down); default = c("black", "grey25",
"grey0") See \url{http://research.stowers-institute.org/efg/R/Color/Chart}
Note: Colors cannot be duplicated.}

\item{symbolFill}{Set the fill color for the symbols. Note only symbols 21-25
are fillable. This will have no effect on other symbols. Default =
c("red3", "grey25", "deepskyblue4") Note: Colors cannot be duplicated.}

\item{alpha}{Controls the transparency of the plotted points (range: 0-1;
default = 0.7)}

\item{sizeByIntensity}{If TRUE, creates a column to support sizeByIntensity. (Default = TRUE)}

\item{pthresholdLine}{Color for a horizontal line at the p-threshold (Default
= NULL (disabled))}

\item{foldChangeLines}{Position of reference vertical lines for fold change
(Default = log2(1.5); NULL disables)}

\item{refLineThickness}{Set the thickness for all reference lines (Default =
1)}

\item{legendPosition}{One of "top", "bottom", "left", "right", "ne", "se",
"nw", "sw", NULL. top/bottom/left/right place the legend outside the
figure.  ne/se/nw/sw place the figure inside the figure. NULL disables the
legend. Default = "right"}

\item{rugColor}{Specify color for rug density plot along x and y axes. Set to NULL
to disable rug layer. (Default = NULL)}

\item{rugAlpha}{Sets the transparency for the rug layer.  An alpha <1.0 can take
a long time to draw, so the default = 1.0.
For a final plot try 0.1 or 0.2 for alpha for a more informative rug.}

\item{baseFontSize}{The smallest size font in the figure in points. Default =
12}

\item{themeStyle}{"bw" or "grey" which correspond to theme_bw or theme_grey
respectively. Default = bw"}

\item{footnote}{Optional string placed right justified at bottom of plot.}

\item{footnoteSize}{Applies to footnote. (Default = 3)}

\item{footnoteColor}{Applies to footnote. (Default = "black")}

\item{footnoteJust}{Value 0 - 1. 0 is left justified, 1 is right justified, 0.5 is centered. (Default = 1)}
}
\value{
ggplot object containing volcano plot
}
\description{
A volcano plot shows Log Ratio data on the X axis and Negative Log P-values (NLP) on the
Y axis. This function is intended to show the volcano plot from a dataframe
created by topTable or topTreat. Properly normalized data will generally be
centered around LogRatio = 0.
}
\details{
By default, the plot places "logFC" on the X axis and Log10 of the "P.Value" on the Y axis.
By default, a reference vertical line is drawn at LogRatio = 0 on the X axis.
Optionally, additional reference lines will be drawn at +/- a user supplied Log Ratio threshold.
The points are color coded using both the significance and fold-change thresholds supplied by the user.
By default, the P.Value field is used with a threshold of 0.01 to color code the points and fold-change
threshold of +/- 1.5X.

\strong{Data Structure for the input dataframe:}

The defaults are set for dataframes produced by topTable and topTreat.  The columns named "logFC"
and "P.Value" are used by default to accommodate the column
names used in topTable/topTreat dataframes.  Any other dataframe
can be used with fold-change, intensity, and significance measures, with appropriate
arguments to define the column names to use provided. By default, the
column names will be used for the axis labels, but can be overridden with xlab and ylab arguments.

A significance measure (which defaults to P.Value <= 0.01) and LogRatio
threshold are used to color code genes that are significantly increased or decreased.
Use the appropriate arguments to use an FDR measure instead of p-value.

Sensible defaults are chosen for symbols (Size, Shape, Color, and Fill), but they can be
adjusted through the use of optional arguments. A length of 3 is
required for these arguments which applies the attributes in this order:
Increased, NoChange, Decreased.
}
\examples{
\dontrun{
   # Simple plot with custom title (contrastDF is a topTable dataframe)
   myPlot <- volcanoPlot(contrastDF, title = "Plot Title")

   # Some options with a custom datafile
   myPlot <- volcanoPlot(contrastDF,
                         pthreshold = 0.1,
                         logRatioCol = "Log2ratio",
                         logIntCol = "AverageIntensity",
                         pvalCol = "BHFDR",
                         xlab = "Log2 Ratio", ylab = "Log10 BHFDR",
                         title = "Profile Plot Title",
                         referenceLine = "blue",
                         legendPosition = "ne")
}

}
